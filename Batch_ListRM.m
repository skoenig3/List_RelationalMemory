% written by Seth Konig 5/7/15
% code automatically runs all analysis for ListRM
clear,clc
fixwin = 3.5; %size of the fixation window/2. Was a width of 7 dva
imageX = 800;
imageY = 600;

data_dir = 'C:\Users\seth.koenig\Documents\MATLAB\List_RelationalMemory\Cortex Data\';
image_dir = 'C:\Users\seth.koenig\Documents\MATLAB\List_RelationalMemory\Image Sets\';
figure_dir = 'C:\Users\seth.koenig\Documents\MATLAB\List_RelationalMemory\Figures\';

%---Vivian Pre-Lesions---%
% cortex_files = {'PW150416.4','PW150417.2','PW150420.2','PW150421.2',...
%     'PW150422.2','PW150423.2','PW150424.2','PW150427.2',...
%     'PW150428.2','PW150429.2','PW150430.2','PW150501.2',...
%     'PW150504.2','PW150505.2','PW150506.2','PW150507.2',...
%     'PW150511.2'};
% 
% item_files = {'ListRM21.itm','ListRM22.itm','ListRM23.itm','ListRM24.itm',...
%     'ListRM25.itm','ListRM26.itm','ListRM27.itm','ListRM28.itm',...
%     'ListRM29.itm','ListRM30.itm','ListRM31.itm','ListRM32.itm',...
%     'ListRM33.itm','ListRM34.itm','ListRM35.itm','ListRM36.itm',....
%     'ListRM37.itm'};

%---Vivian Post-Lesion---%
% item_files = {'ListRM01.itm','ListRM02.itm','ListRM03.itm','ListRM04.itm','ListRM05.itm',...
%               'ListRM06.itm','ListRM07.itm','ListRM08.itm','ListRM09.itm','ListRM10.itm',...
%               'ListRM11.itm','ListRM12.itm','ListRM13.itm','ListRM14.itm','ListRM15.itm'};
% 
% cortex_files = {'PW160310.2','PW160311.2','PW160314.2','PW160315.2','PW160316.2',...
%                 'PW160317.2','PW160318.2','PW160321.2','PW160322.2','PW160323.2',...
%                 'PW160324.2','PW160325.2','PW160328.2','PW160329.2','PW160330.2'};

% % %---Red Pre-Lesion--%%
% cortex_files = {'RR150423.2','RR150424.2','RR150427.2','RR150428.2','RR150429.2',...
%     'RR150430.2','RR150501.2','RR150504.2','RR150505.2','RR150506.2',...
%     'RR150507.2','RR150508.2','RR150511.2','RR150512.2','RR150513.2',...
%     'RR150515.2','RR150518.2','RR150519.2','RR150520.2','RR150521.2'};
% item_files = {'ListRM01.itm','ListRM02.itm','ListRM03.itm','ListRM04.itm','ListRM05.itm',...
%     'ListRM06.itm','ListRM07.itm','ListRM08.itm','ListRM09.itm','ListRM10.itm',...
%     'ListRM11.itm','ListRM12.itm','ListRM13.itm','ListRM14.itm','ListRM15.itm',...
%     'ListRM16.itm','ListRM17.itm','ListRM18.itm','ListRM19.itm','ListRM20.itm'};
% 
% %---Red Post-Lesion
% item_files = {'ListRM21.itm','ListRM22.itm','ListRM23.itm','ListRM24.itm',...
%               'ListRM25.itm','ListRM26.itm','ListRM27.itm','ListRM28.itm',...
%               'ListRM29.itm','ListRM30.itm','ListRM31.itm','ListRM32.itm',...
%               'ListRM33.itm','ListRM34.itm','ListRM35.itm','ListRM36.itm',...
%               'ListRM37.itm','ListRM38.itm','ListRM39.itm','ListRM40.itm'};
% cortex_files = {'RR160324.2','RR160325.1','RR160328.2','RR160330.2',...
%                 'RR160331.2','RR160401.2','RR160405.2','RR160406.2',...
%                 'RR160407.2','RR160408.2','RR160411.2','RR160412.2',...
%                 'RR160413.2','RR160414.2','RR160415.2','RR160418.2',...
%                 'RR160419.2','RR160420.2','RR160421.2','RR160422.2'};

% %---Tobii Pre-lesion---%
% cortex_files = {'TO150513.2','TO150514.2','TO150515.2','TO150518.2','TO150519.2',...
%     'TO150520.2','TO150521.2','TO150522.2','TO150526.2','TO150527.2',...
%     'TO150528.2','TO150529.2','TO150601.2','TO150602.2','TO150603.2',...
%     'TO150604.2','TO150605.2'};
% item_files = {'ListRM01.itm','ListRM02.itm','ListRM03.itm','ListRM04.itm','ListRM05.itm',...
%     'ListRM06.itm','ListRM07.itm','ListRM08.itm','ListRM09.itm','ListRM10.itm',...
%     'ListRM11.itm','ListRM12.itm','ListRM13.itm','ListRM14.itm','ListRM15.itm',...
%     'ListRM16.itm','ListRM17.itm'};

%---Tobii Post Lesion---%
%lots of sessions skipped b/c tubing issues
cortex_files = {'TO170404.2','TO170405.2','TO170406.2','TO170407.2',...
                'TO170410.2','TO170411.2','TO170412.2','TO170414.2',...
                'TO170419.2','TO170421.2','TO170425.2','TO170426.2',...
                'TO170427.2','TO170428.2','TO170501.2'};
item_files = {'ListRM22.itm','ListRM23.itm','ListRM24.itm','ListRM25.itm',...
              'ListRM26.itm','ListRM27.itm','ListRM28.itm','ListRM30.itm',...
              'ListRM33.itm','ListRM35.itm','ListRM36.itm','ListRM37.itm',...
              'ListRM38.itm','ListRM39.itm','ListRM40.itm'};

% cortex_files = {'TT150427.2','TT150428.2','TT150429.2','TT150430.2','TT150501.2',...
%     'TT150504.2','TT150505.2','TT150506.2','TT150507.2','TT150508.2',...
%     'TT150511.2','TT150512.2','TT150513.2','TT150514.2','TT150515.2'};%,...
% item_files = {'ListRM01.itm','ListRM02.itm','ListRM03.itm','ListRM04.itm','ListRM05.itm',...
%     'ListRM06.itm','ListRM07.itm','ListRM08.itm','ListRM09.itm','ListRM10.itm',...
%     'ListRM11.itm','ListRM12.itm','ListRM13.itm','ListRM14.itm','ListRM15.itm'};%,...

%---Manfred Pre-Lesion---%
% cortex_files = {'MF170111.2','MF170112.2','MF170117.2','MF170118.2',...
%                 'MF170119.2','MF170120.2','MF170123.2','MF170126.2',...
%                 'MF170130.2','MF170131.2','MF170201.2','MF170202.2',...
%                 'MF170209.2','MF170210.2','MF170213.2'};
% item_files = {'ListRM21.itm','ListRM22.itm','ListRM23.itm','ListRM24.itm',...
%               'ListRM25.itm','ListRM26.itm','ListRM27.itm','ListRM28.itm',...
%               'ListRM29.itm','ListRM30.itm','ListRM31.itm','ListRM32.itm',...
%               'ListRM33.itm','ListRM34.itm','ListRM35.itm'};




%---All Pre-lesion Files---%
% cortex_files = {'MF170111.2','MF170112.2','MF170117.2','MF170118.2',...
%                 'MF170119.2','MF170120.2','MF170123.2','MF170126.2',...
%                 'MF170130.2','MF170131.2','MF170201.2','MF170202.2',...
%                 'MF170209.2','MF170210.2','MF170213.2',...
%                 'RR150423.2','RR150424.2','RR150427.2','RR150428.2','RR150429.2',...
%                 'RR150430.2','RR150501.2','RR150504.2','RR150505.2','RR150506.2',...
%                 'RR150507.2','RR150508.2','RR150511.2','RR150512.2','RR150513.2',...
%                 'RR150515.2','RR150518.2','RR150519.2','RR150520.2','RR150521.2',...
%                 'PW150416.4','PW150417.2','PW150420.2','PW150421.2',...
%                 'PW150422.2','PW150423.2','PW150424.2','PW150427.2',...
%                 'PW150428.2','PW150429.2','PW150430.2','PW150501.2',...
%                 'PW150504.2','PW150505.2','PW150506.2','PW150507.2',...
%                 'PW150511.2',...
%                 'TO150513.2','TO150514.2','TO150515.2','TO150518.2','TO150519.2',...
%                 'TO150520.2','TO150521.2','TO150522.2','TO150526.2','TO150527.2',...
%                 'TO150528.2','TO150529.2','TO150601.2','TO150602.2','TO150603.2',...
%                 'TO150604.2','TO150605.2'};
    
    
                
% item_files = {'ListRM21.itm','ListRM22.itm','ListRM23.itm','ListRM24.itm',...
%               'ListRM25.itm','ListRM26.itm','ListRM27.itm','ListRM28.itm',...
%               'ListRM29.itm','ListRM30.itm','ListRM31.itm','ListRM32.itm',...
%               'ListRM33.itm','ListRM34.itm','ListRM35.itm',...
%             'ListRM01.itm','ListRM02.itm','ListRM03.itm','ListRM04.itm','ListRM05.itm',...
%             'ListRM06.itm','ListRM07.itm','ListRM08.itm','ListRM09.itm','ListRM10.itm',...
%             'ListRM11.itm','ListRM12.itm','ListRM13.itm','ListRM14.itm','ListRM15.itm',...
%             'ListRM16.itm','ListRM17.itm','ListRM18.itm','ListRM19.itm','ListRM20.itm',...
%             'ListRM21.itm','ListRM22.itm','ListRM23.itm','ListRM24.itm',...
%             'ListRM25.itm','ListRM26.itm','ListRM27.itm','ListRM28.itm',...
%             'ListRM29.itm','ListRM30.itm','ListRM31.itm','ListRM32.itm',...
%             'ListRM33.itm','ListRM34.itm','ListRM35.itm','ListRM36.itm',....
%             'ListRM37.itm',...
%             'ListRM01.itm','ListRM02.itm','ListRM03.itm','ListRM04.itm','ListRM05.itm',...
%             'ListRM06.itm','ListRM07.itm','ListRM08.itm','ListRM09.itm','ListRM10.itm',...
%             'ListRM11.itm','ListRM12.itm','ListRM13.itm','ListRM14.itm','ListRM15.itm',...
%             'ListRM16.itm','ListRM17.itm'};
    

%%%---Preprocess all the ListRM data---%%%
%figure_dir = 'C:\Users\seth.koenig\Documents\MATLAB\List_RelationalMemory\Figures\Calibration\';
% for file =length(cortex_files)
%     ImportListRMData(cortex_files{file},item_files{file},figure_dir,data_dir );
% end
%%
%%%---Check quality ListRM data---%%%
% make sure had at least 64 "good" (din't look away too much) viewings
% for file =3%1:length(cortex_files)
%     CheckListRMData(data_dir,[cortex_files{file}(1:8) '_' cortex_files{file}(end) '-fixation.mat']);
% end
%%
%%---Determine Fixation Durations, Saccade Amplitudes, Pupil Diameter Across Multiple Sets---%
%combinedEyeMovementStats(data_dir,cortex_files)
%%
%---Calculate IOR---%
% for file =1:length(cortex_files)
%     ListRM_IOR(data_dir,cortex_files{file},image_dir,figure_dir);
% end
%%
%%%---Calculate Percent of Image Explored--%%%
% for file =1:length(cortex_files)
%     CalculateCovergeListRMData(data_dir,[cortex_files{file}(1:8) '_' cortex_files{file}(end) '-fixation.mat']);
% end
% disp('Done Coverage')

%%%---Determine Percent of Image Explored Across Multiple Sets---%%%
% combinedCoverage(data_dir,cortex_files)
% 
% %%%---Determine The Similarity in Fixation Locations---%%%
% for file = 1:length(cortex_files)
%    DetermineListRMSpatialSimilarity(data_dir,[cortex_files{file}(1:8) '_' cortex_files{file}(end) '-fixation.mat']) 
% end
% disp('Done Similarity')


%%%---Determine Similarity Across Multiple Sets---%%%
% combinedSimilarity(data_dir,cortex_files)

%%%---Get Salience Maps for each image---%%%
%only need to run 1 time!
% img_dir = 'C:\Users\seth.koenig\Documents\MATLAB\List_RelationalMemory\Image Sets\';
% for set = 1:40
%     if set < 10
%         setzero = '0';
%     else
%         setzero = '';
%     end
%     
%     cd([img_dir 'LRM' setzero num2str(set) '\']);
%     
%     for img = 1:96
% 
%         if img < 10
%             imgzero = '0';
%         else
%             imgzero = '';
%         end
%         getSalienceMap(['S' setzero num2str(set) 'I' imgzero num2str(img) '.bmp'])
%     end
% end
% 
% %%%---Calculate Salience at Fixation Locations---%%%
% for file =1:length(cortex_files)
%     CalculateSalienceatFixationsListRM(cortex_files{file},data_dir,image_dir,imageX,imageY)
% end
% disp('Done Salience')

% %%%---Determine Salience at Fixation Locations Across Multiple Sets---%%%
CombinedSalienceListRM(cortex_files,data_dir,figure_dir)